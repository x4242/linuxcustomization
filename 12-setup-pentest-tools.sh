#!/usr/bin/env bash

# Description:
# ------------
# tbd
#
# lastmod: 2019-09-08T11:16:57+02:00
# Change History:
# ---------------
#   - 2019-09-08: added pacman/yay db snc prior to install
#   - 2019-07-21: added chack if yay is installed and root/sudo check
#   - 2019-07-20: printf corrections
#   - 2019-07-18: created, moved from personal-setup.sh

# String definitions for colored printf output
# [ ERROR ] in light red
# [ INFO  ] in light green
# [ INPUT ] in light yellow
STR_ERROR="[ \e[91mERROR\e[0m ]"
STR_INFO="[ \e[92mINFO\e[0m  ]"
#STR_INPUT="[ \e[93mINPUT\e[0m ]"

##########################################
# Check if root / sudo
##########################################
if [ "$EUID" -eq 0 ]; then
  printf "%b Do not run with sudo / as root.\n" "${STR_ERROR}" >&2
  exit 1
fi

sudo pacman -Sy

printf "%b Installing pentesting packages...\n" "${STR_INFO}"

##########################################
# Official packages
##########################################
printf "%b Installing official packages...\n" "${STR_INFO}"
sudo pacman -S --noconfirm --needed metasploit
sudo pacman -S --noconfirm --needed john
sudo pacman -S --noconfirm --needed hashcat
sudo pacman -S --noconfirm --needed sqlmap
sudo pacman -S --noconfirm --needed exploitdb
sudo pacman -S --noconfirm --needed wpscan

##########################################
# AUR packages
##########################################
bash ./91-helper-check-installed.sh yay
if [[ $? == 0 ]]; then
  yay -Sy
  printf "%b Installing AUR packages...\n" "${STR_INFO}"
  yay -S --noconfirm burpsuite
  yay -S --noconfirm gobuster-git
  yay -S --noconfirm dirbuster
  yay -S --noconfirm hash-identifier
  yay -S --noconfirm seclists-git
  yay -S --noconfirm rockyou
  yay -S --noconfirm responder
else
  printf "%b Couldn't install AUR packages as 'yay' is not installed.\n" "${STR_ERROR}" >&2
  exit 1
fi


##########################################
# Create directories and links
##########################################
printf "%b Creating links and directories...\n" "${STR_INFO}"
if [[ ! -d /usr/share/wordlists ]]; then sudo mkdir /usr/share/wordlists; fi
if [[ -d /usr/share/dirbuster ]]; then sudo ln -sf /usr/share/dirbuster /usr/share/wordlists/dirbuster; fi
if [[ -e /usr/share/dict/rockyou.txt ]]; then sudo ln -sf /usr/share/dict/rockyou.txt /usr/share/wordlists/rockyou.txt; fi

printf "%b Done installing pentesting packages.\n" "${STR_INFO}"
exit 0
